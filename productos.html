<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>ğŸ¹ Productos - Admin VLACK</title>
  <link rel="stylesheet" href="admin.css">
</head>

<body>

<!-- ğŸ” LOGIN -->
<div class="login-container" id="loginBox">
  <h2>ğŸ” INGRESAR ADMIN</h2>
  <input type="email" id="user" placeholder="Email">
  <input type="password" id="pass" placeholder="ContraseÃ±a">
  <button onclick="login()">Ingresar</button>
</div>

<!-- ğŸ§­ PANEL -->
<div id="productosPanel" style="display:none; padding:20px;">

  <h1>ğŸ¹ AdministraciÃ³n de Productos</h1>
  <p id="adminStatus"></p>

  <nav class="nav-bar">
    <button onclick="mostrarSeccion('tragos')">ğŸ¸ Tragos</button>
    <button onclick="mostrarSeccion('promos')">â­ Promos</button>
    <button onclick="mostrarSeccion('comidas')">ğŸ• Comidas</button>
    <button onclick="location.href='admin.html'">â¬… Volver</button>
    <button onclick="logout()">ğŸšª Salir</button>
  </nav>

  <!-- ================= TRAGOS ================= -->
  <section id="seccion-tragos" class="seccion-panel">

    <h3>â• Agregar Trago</h3>

    <input id="tragosNombre" placeholder="Nombre del trago">
    <input id="tragosPrecio" type="number" placeholder="Precio">

    <textarea
      id="tragosDescripcion"
      placeholder="DescripciÃ³n / ingredientes del trago"
      rows="3"
    ></textarea>

    <label>ğŸ–¼ Imagen:</label>
    <select id="tragosImagenSelect">
   <option value="img/trago-flynpaff.png">Trago Flynpaff</option>
<option value="img/trago-lemondchamp.png">Trago Lemondchamp</option>
<option value="img/trago-mocha-vlack.jpg">Trago Mocha Vlack</option>
<option value="img/trago-sangria.jpg">Trago SangrÃ­a</option>
<option value="img/trago serenito.png">Trago SERENITO</option>
<option value="img/trago-sangria.jpg">Trago MILI PILI</option>

    </select>

    <input id="tragosImagenURL" placeholder="O pegar URL externa">

    <button onclick="agregar('tragos')">Agregar</button>

    <h3>ğŸ“‹ Listado</h3>
    <div id="lista-tragos"></div>
  </section>

  <!-- ================= PROMOS ================= -->
  <section id="seccion-promos" class="seccion-panel" style="display:none;">

    <h3>â• Agregar Promo</h3>

    <input id="promosNombre" placeholder="Nombre promo">
    <input id="promosPrecio" type="number" placeholder="Precio">

    <textarea
      id="promosDescripcion"
      placeholder="DescripciÃ³n de la promo"
      rows="3"
    ></textarea>

    <select id="promosImagenSelect">
      <option value="">-- Elegir imagen --</option>
      <option value="img/4 x 3 FLYNPAFF.png">Promo 4x3 Flynpaff</option>
      <option value="img/Imagen Santi con milipili y serenito.jpg">
        Santi Milipili Serenito
      </option>
      <option value="img/Imagen Santi con milipili y serenito iluminada.jpg">
        Santi Iluminada
      </option>
      <option value="img/promo-sangria-x2.png">
  Sangria x 2
</option>

    </select>

    <input id="promosImagenURL" placeholder="O URL externa">

    <button onclick="agregar('promos')">Agregar</button>

    <h3>ğŸ“‹ Listado</h3>
    <div id="lista-promos"></div>
  </section>

  <!-- ================= COMIDAS ================= -->
  <section id="seccion-comidas" class="seccion-panel" style="display:none;">

    <h3>â• Agregar Comida</h3>

    <input id="comidasNombre" placeholder="Nombre comida">
    <input id="comidasPrecio" type="number" placeholder="Precio">

    <textarea
      id="comidasDescripcion"
      placeholder="DescripciÃ³n del producto"
      rows="3"
    ></textarea>

    <select id="comidasImagenSelect">
      <option value="">-- Elegir imagen --</option>
      <option value="img/Logo de vlack Point drinks.jpg">
        Logo Vlack Point Drinks
      </option>
    </select>

    <input id="comidasImagenURL" placeholder="O URL externa">

    <button onclick="agregar('comidas')">Agregar</button>

    <h3>ğŸ“‹ Listado</h3>
    <div id="lista-comidas"></div>
  </section>

</div>

<!-- ğŸ”¥ SCRIPT -->
<script type="module">
  import { auth, db } from "./firebase.js";
  import {
    signInWithEmailAndPassword,
    onAuthStateChanged,
    signOut
  } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-auth.js";

  import {
    collection,
    addDoc,
    getDocs,
    deleteDoc,
    doc
  } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";

  // LOGIN
  window.login = () =>
    signInWithEmailAndPassword(auth, user.value, pass.value)
      .catch(() => alert("Login incorrecto"));

  window.logout = () => signOut(auth);

  onAuthStateChanged(auth, user => {
    if (user) {
      loginBox.style.display = "none";
      productosPanel.style.display = "block";
      adminStatus.textContent = `Logueado como: ${user.email}`;
      cargarTodo();
    } else {
      loginBox.style.display = "block";
      productosPanel.style.display = "none";
    }
  });

  window.mostrarSeccion = sec => {
    document.querySelectorAll(".seccion-panel")
      .forEach(s => s.style.display = "none");
    document.getElementById(`seccion-${sec}`).style.display = "block";
  };

  async function cargarTodo() {
    cargar("tragos");
    cargar("promos");
    cargar("comidas");
  }

  async function cargar(col) {
    const cont = document.getElementById(`lista-${col}`);
    cont.innerHTML = "Cargando...";
    const snap = await getDocs(collection(db, col));

    cont.innerHTML = snap.docs.map(d => {
      const p = d.data();
      return `
        <div style="border:1px solid #333; padding:10px; margin:10px;">
          <b>${p.nombre}</b> - $${p.precio}<br>
          ${p.descripcion ? `<small>${p.descripcion}</small><br>` : ""}
          ${p.imagen ? `<img src="${p.imagen}?v=${Date.now()}" width="80">` : ""}
          <br>
          <button onclick="eliminar('${col}','${d.id}')">âŒ</button>
        </div>
      `;
    }).join("");
  }

  window.agregar = async col => {
    const nombre = document.getElementById(col + "Nombre").value;
    const precio = document.getElementById(col + "Precio").value;
    const descripcionInput = document.getElementById(col + "Descripcion");
    const descripcion = descripcionInput ? descripcionInput.value : "";

    const sel = document.getElementById(col + "ImagenSelect").value;
    const url = document.getElementById(col + "ImagenURL").value;
    const imagen = sel || url;

    if (!nombre || !precio) {
      alert("Faltan datos");
      return;
    }

    await addDoc(collection(db, col), {
      nombre,
      precio,
      imagen,
      descripcion
    });

    cargar(col);
  };

  window.eliminar = async (col, id) => {
    if (!confirm("Eliminar producto?")) return;
    await deleteDoc(doc(db, col, id));
    cargar(col);
  };
</script>

</body>
</html>
